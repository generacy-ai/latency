# Data Model: Document planned facets and reconcile dual StateStore

This feature involves documentation and interface renaming, not new data structures. This document captures the interface relationships being modified.

## Interface Relationships

### Before (Current State)

```
┌─────────────────────────────────────────────────────────────────┐
│                          src/index.ts                           │
│  exports: StateStore (from composition) + StateStore (via *)    │
└─────────────────────────────────────────────────────────────────┘
            │                                     │
            ▼                                     ▼
┌───────────────────────────┐       ┌───────────────────────────┐
│  composition/index.ts     │       │    facets/index.ts        │
│  StateStore               │       │    export * from state.ts │
└───────────────────────────┘       └───────────────────────────┘
            │                                     │
            ▼                                     ▼
┌───────────────────────────┐       ┌───────────────────────────┐
│  composition/context.ts   │       │    facets/state.ts        │
│  interface StateStore     │       │    interface StateStore   │
│  (sync, plugin-scoped)    │       │    (async, persistent)    │
└───────────────────────────┘       └───────────────────────────┘

⚠️ NAMING COLLISION: Two different interfaces share the name "StateStore"
```

### After (Target State)

```
┌─────────────────────────────────────────────────────────────────┐
│                          src/index.ts                           │
│  exports: PluginStateStore + StateStore (via facets)            │
└─────────────────────────────────────────────────────────────────┘
            │                                     │
            ▼                                     ▼
┌───────────────────────────┐       ┌───────────────────────────┐
│  composition/index.ts     │       │    facets/index.ts        │
│  PluginStateStore         │       │    export * from state.ts │
└───────────────────────────┘       └───────────────────────────┘
            │                                     │
            ▼                                     ▼
┌───────────────────────────┐       ┌───────────────────────────┐
│  composition/context.ts   │       │    facets/state.ts        │
│  interface PluginStateStore│      │    interface StateStore   │
│  (sync, plugin-scoped)    │       │    (async, persistent)    │
└───────────────────────────┘       └───────────────────────────┘
            │
            ▼
┌───────────────────────────┐
│      PluginContext        │
│  readonly state:          │
│    PluginStateStore       │
└───────────────────────────┘

✓ RESOLVED: Each interface has a unique, descriptive name
```

## Interface Definitions

### PluginStateStore (Renamed)

```typescript
/**
 * Minimal key-value state store scoped to a plugin.
 * Synchronous operations for in-memory plugin state.
 */
export interface PluginStateStore {
  /** Retrieve a value by key, or undefined if not set */
  get<T>(key: string): T | undefined;

  /** Set a value for a key */
  set<T>(key: string, value: T): void;

  /** Delete a key, returning true if it existed */
  delete(key: string): boolean;

  /** Check whether a key exists */
  has(key: string): boolean;
}
```

### StateStore (Facet - Unchanged)

```typescript
/**
 * Generic key-value state persistence interface.
 * Async operations for persistent storage backends.
 */
export interface StateStore {
  get<T = unknown>(key: string): Promise<T | undefined>;
  set<T = unknown>(key: string, value: T): Promise<void>;
  delete(key: string): Promise<boolean>;
  has(key: string): Promise<boolean>;
  keys(prefix?: string): Promise<string[]>;
}
```

## Facet Maturity Categories

| Category | Description | Facets |
|----------|-------------|--------|
| **Active** | Implemented with working providers | IssueTracker, SourceControl, DevAgent, Logger, Pipeline |
| **Awaiting Adoption** | Defined and stable, awaiting Phase 3 consumers | EventBus, SecretStore, StateStore, DecisionHandler, WorkflowEngine |

---

*Generated by speckit*
