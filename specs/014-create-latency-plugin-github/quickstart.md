# Quickstart: GitHub Actions Plugin

## Installation

```bash
pnpm add @generacy-ai/latency-plugin-github-actions @generacy-ai/github-actions-interface
```

Peer dependencies (install if not already present):
```bash
pnpm add @generacy-ai/latency @generacy-ai/latency-plugin-ci-cd
```

## Usage

### Basic Setup

```typescript
import { GitHubActionsPlugin } from '@generacy-ai/latency-plugin-github-actions';

const plugin = new GitHubActionsPlugin({
  token: process.env.GITHUB_TOKEN!,
  owner: 'my-org',
  repo: 'my-repo',
});
```

### Trigger a Workflow

```typescript
const run = await plugin.triggerPipeline('ci.yml', {
  branch: 'main',
  parameters: { environment: 'staging' },
});
// run.status === 'pending' (synthetic â€” dispatch succeeded)
```

### Check Run Status

```typescript
const status = await plugin.getPipelineStatus('12345678');
console.log(status.status); // 'pending' | 'running' | 'completed' | 'failed' | 'cancelled'
```

### Cancel a Run

```typescript
await plugin.cancelPipeline('12345678');
```

### List Workflows

```typescript
const workflows = await plugin.listPipelines();
for (const wf of workflows) {
  console.log(`${wf.name} (${wf.path})`);
}
```

### GitHub-Specific Methods

```typescript
// Get logs
const logs = await plugin.getWorkflowLogs(12345678);

// Re-run a workflow
const rerun = await plugin.rerunWorkflow(12345678);

// List artifacts
const artifacts = await plugin.listArtifacts(12345678);

// Download an artifact
const buffer = await plugin.downloadArtifact(99999);
```

### Type Guards

```typescript
import { isGitHubWorkflowRun, getWorkflowRunUrl } from '@generacy-ai/github-actions-interface';

const run = await plugin.getPipelineStatus('12345678');

if (isGitHubWorkflowRun(run)) {
  console.log(`Run #${run.runNumber}, attempt ${run.attempt}`);
  console.log(`Branch: ${run.headBranch}, SHA: ${run.headSha}`);
  console.log(getWorkflowRunUrl(run, 'my-org', 'my-repo'));

  for (const job of run.jobs) {
    console.log(`  ${job.name}: ${job.status} (${job.conclusion ?? 'in progress'})`);
  }
}
```

### GitHub Enterprise

```typescript
const plugin = new GitHubActionsPlugin({
  token: process.env.GHE_TOKEN!,
  owner: 'my-org',
  repo: 'my-repo',
  apiBaseUrl: 'https://github.example.com/api/v3',
});
```

## Development

### Build

```bash
# From repo root
pnpm --filter @generacy-ai/github-actions-interface build
pnpm --filter @generacy-ai/latency-plugin-github-actions build
```

### Test

```bash
pnpm --filter @generacy-ai/latency-plugin-github-actions test
```

### Type Check

```bash
pnpm --filter @generacy-ai/github-actions-interface typecheck
pnpm --filter @generacy-ai/latency-plugin-github-actions typecheck
```

## Troubleshooting

| Problem | Cause | Solution |
|---------|-------|----------|
| `FacetError: AUTH` | Invalid or expired token | Check `GITHUB_TOKEN` has `actions:write` scope |
| `FacetError: NOT_FOUND` | Wrong owner/repo or workflow ID | Verify owner, repo, and workflow file name |
| `triggerPipeline` returns pending but run never appears | Workflow not configured for `workflow_dispatch` | Add `workflow_dispatch` trigger to the workflow YAML |
| `FacetError: VALIDATION_ERROR` | Empty string passed for required parameter | Ensure pipelineId/runId are non-empty strings |

---

*Generated by speckit*
